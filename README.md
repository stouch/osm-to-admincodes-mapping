# World administrative areas : From OSM/WOF/Geoname id to _AdminCode_

What we call _AdminCode_ is a common 2-3 digits (or letters) of an administrative area.
For example, the subarea "Sa√¥ne-et-Loire", in France, is _71_.

We often need to get quickly the _AdminCode_ of an admin area, but we only got its WOF (Whosonfirst), or its OSM (OpenStreetMap), or even its GeoNames id. Depending on endpoints we used to fetch the data, these ids are rarely returned with the area _AdminCode_.

This project goals to map, in JSON files, the worldwide administrative areas, from different taxonomies (WOF, OSM, GN), with their common _AdminCode_.

Mappings are in `./output`

### Example

`./output/osm-to-admin-codes/FR.json`

```json
{
  "osm:relation:3792877": {
    "code": "84",
    "identifier": "ARA",
    "children": {
      "osm:relation:7411": { "code": "01" },
      "osm:relation:1450201": { "code": "03" },
      "osm:relation:7430": { "code": "07" },
      "osm:relation:7381": { "code": "15" },
      "osm:relation:7434": { "code": "26" },
      "osm:relation:7452": { "code": "43" },
      "osm:relation:7407": { "code": "74" },
      "osm:relation:7437": { "code": "38" },
      "osm:relation:7420": { "code": "42" },
      "osm:relation:7406": { "code": "63" },
      "osm:relation:4850451": { "code": "69" },
      "osm:relation:7425": { "code": "73" }
    }
  },
  "osm:relation:3792878": {
    "code": "27",
    "identifier": "BFC",
    "children": {
      "osm:relation:7424": { "code": "21" },
```

## Prerequisites

You need to set the .env file, with your ChatGPT token and the Nominatim server you want to use.
**Be warned that the official Nominatim server has rate usage limits.**

## Installation

```bash
nvm use
npm ci
```

## Dev (new country)

Create a `./prompts/<country>.txt` for ChatGPT, and then you can execute Usage commands below.

## Usage

```bash
node main.js FR
```

This will create 2 datasets :

- (If not exists) : Structured admin areas of the country, generated by ChatGPT, in `./data/admin-areas`
- Enriched admin areas with, for each area and subarea, the matching WOF, OSM and Geonames ids, in `./data/enriched-admin-areas`

Then :

```bash
node map-osm-to-codes.js FR
```

The final outputs in `./output/osm-to-admin-codes`
